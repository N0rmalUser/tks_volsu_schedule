# Работа с ботом для самых маленьких

## Как запустить бота

* Открыть `Dockerfile`
* Заполнить поля с ENV
* Запустить контейнер

## Где находятся настройки бота

Файл с настройками находится в папке `data/config.py`
Там все преподаватели, увс, колледжские и группы и кабинеты

## Как получить базу данных с расписаниями

* Расписания колледжа (`xlsx`) и университета (`docs` НЕ `PDF`!) засунуть в `/preparation/schedules/`
* Расписание университетских групп должно быть разделено на фалы по подгруппам (РСК-211 - первая подгруппа, РСК-211_2 -
  вторая)
* Затем запустить файл `university_converter.py` и `college_converter.py`
* Переместить полученный файл в `data/` (если в `config.py` не указан другой путь)

## Как заменить расписание в боте. 2 способа

1. сделать контейнер сразу с нужными базами данных
2. через `#General` закинуть файлы баз данных с названием:
    * `schedule.db` - расписание
    * `users.db` - база данных всех пользователей
    * `activities.db` - база данных активности пользователей  
      __Если название будет другим, ничего не поменяется!__

## Как отправлять сообщения пользователям бота

В `config.py` есть переменная `GROUP_CHAT_ID`, указывающая id чата,
в котором создаются топики пользователей, нажавших на кнопку "Начать" в боте.  
Написав сообщение в этот чат, оно будет отправлено этому пользователю.  
Если отправить сообщение в "General", сообщение получат все пользователи бота.

## Какие команды поддерживает бот

### Обычные юзвери могут использовать только:

| Команда  | Пояснение                                                                                                                          |
|----------|:-----------------------------------------------------------------------------------------------------------------------------------|
| `/start` | Начать работу с ботом                                                                                                              |
| `/help`  | Выводит текст, объясняющий, что да как в боте                                                                                      |
| `/admin` | Написать админу (в админском чате появится сообщение с просьбой о помощи и автоматом врубится слежение за действиями пользователя) |

### Админы могут использовать те же команды, что и юзвери, а также:

| Команда         | Пояснение                                                                                                                                           |
|-----------------|:----------------------------------------------------------------------------------------------------------------------------------------------------|
| `/track start`  | Включить слежение за действиями пользователя (если написан в топике, то только за этим юзером, если в "General", то за всеми)                       |
| `/track stop`   | Выключить слежение за действиями пользователя. Те же правила, что и при start                                                                       |
| `/track status` | Проверить, включено ли слежение за действиями пользователя. Если написать в General, показывает список пользователей, за которыми включено слежение |
| `/dump`         | Последовательная отправка файла логов, его отчистка, отправка базы данных                                                                           |
| `/info`         | Присылает всю ключевую инфу пользователя из бд (не работает в "General")                                                                            |
| `/hours_stat`   | Статистика пользователей по часам за определённый день в формате DD.MM.YY. Если ничего не присылать, показывает статистику за сегодня.              |
| `/days_stat`    | Статистика пользователей по дням за последние 30 дней.                                                                                              |
| `/bun`          | Банит пользователя, не обрабатывая его сообщения и нажатия на кнопки                                                                                |
| `/unbun`        | Отмена бана                                                                                                                                         |

__Админские команды работают только в группе и не пересылаются пользователям__

Можно переименовывать топики и изменять их иконки. Всё завязано на id топика и группы, так что это ни как не повлияет на
работу бота.
